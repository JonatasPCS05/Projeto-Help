{% extends 'global/partials/base.html' %}

{% block nav %}
    {% include 'global/partials/navUser.html' %}
{% endblock nav %}

{% block title %}Oportunidades | {% endblock title %}

{% block content %}
<div class="main-content container">
    <h2>Oportunidades Disponíveis</h2>

    {% if messages %}
        {% for message in messages %}
            <div class="message {{ message.tags }}">{{ message }}</div>
        {% endfor %}
    {% endif %}

    <table class="table">
      <thead>
        <tr>
          <th>Cliente</th>
          <th>Serviço</th>
          <th>Local</th>
          <th>Ações</th>
        </tr>
      </thead>
      <tbody>
        {% for servico in servicos %}
          <tr>
            <td>{{ servico.usuario.username }}</td>
            <td>
                <strong>{{ servico.get_tipo_servico_display }}</strong><br>
                <small style="color: #666;">{{ servico.descricao|truncatechars:50 }}</small>
            </td>
            <td>{{ servico.endereco }}</td>
            <td>
              <a href="{% url 'sistema:enviar_proposta' servico.id %}" class="btn btn-azul" style="background-color: #28a745;">Aceitar</a>
              <a href="{% url 'sistema:recusar_oportunidade' servico.id %}" class="btn btn-danger">Recusar</a>
            </td>
          </tr>
        {% empty %}
          <tr><td colspan="4">Nenhuma oportunidade disponível no momento.</td></tr>
        {% endfor %}
      </tbody>
    </table>
</div>
{% endblock %}